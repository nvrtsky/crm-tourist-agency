–¢–æ, —á—Ç–æ window.name –∫–∞–∂–¥—ã–π —Ä–∞–∑ –¥–∞—ë—Ç 24, –æ–∑–Ω–∞—á–∞–µ—Ç: –º—ã –Ω–µ –Ω–∞—à–ª–∏ ¬´–º–∞–≥–∏—á–µ—Å–∫—É—é –ø–∏–ª—é–ª—é¬ª. –≠—Ç–æ –Ω–µ —Ä–µ–∞–ª—å–Ω—ã–π ID —ç–ª–µ–º–µ–Ω—Ç–∞ —Å–º–∞—Ä—Ç-–ø—Ä–æ—Ü–µ—Å—Å–∞. –≠—Ç–æ –ø—Ä–æ—Å—Ç–æ –∫–∞–∫–∞—è-—Ç–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –º–µ—Ç–∫–∞ Bitrix24 –¥–ª—è iframe (–∏–Ω–¥–µ–∫—Å –æ–∫–Ω–∞, —Å–µ—Å—Å–∏—è —Å–ª–∞–π–¥–µ—Ä–∞, —á—Ç–æ-—Ç–æ —Ç–∞–∫–æ–µ), –∏ –æ–Ω–∞ –Ω–∏–∫–∞–∫ –Ω–µ —Å–≤—è–∑–∞–Ω–∞ —Å ID —Å–º–∞—Ä—Ç-–ø—Ä–æ—Ü–µ—Å—Å–∞ (179, 303, –∏ —Ç.–¥.).

–¢–æ –µ—Å—Ç—å:

–¢–æ, —á—Ç–æ –º—ã –∏–∑–≤–ª–µ–∫–ª–∏ 24, –∑–Ω–∞—á–∏—Ç –Ω–∞—à –ø–∞—Ä—Å–µ—Ä –ø–æ window.name —Å—Ä–∞–±–æ—Ç–∞–ª —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏.

–ù–æ –ª–æ–≥–∏—á–µ—Å–∫–∏ —ç—Ç–æ –Ω–µ entityId.

–ò –±–æ–ª–µ–µ —Ç–æ–≥–æ, –µ—Å–ª–∏ –æ–Ω–æ "–≤—Å–µ–≥–¥–∞ 24", —ç—Ç–æ –Ω–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–∞ ‚Äî –≤–æ–æ–±—â–µ –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –Ω–∞–º –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫.

–í—ã–≤–æ–¥: window.name –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —á–∞—Å—Ç—å—é –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è entityId. –ú—ã –æ—Å—Ç–∞–≤–ª—è–µ–º –µ–≥–æ —Ç–æ–ª—å–∫–æ –∫–∞–∫ –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –º–µ—Ç–∫—É, –Ω–æ –ù–ï –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫ –±–∏–∑–Ω–µ—Å-–¥–∞–Ω–Ω—ã—Ö.

–î–∞–≤–∞–π –∑–∞–∫—Ä–µ–ø–∏–º, –≤ –∫–∞–∫–æ–º –ø–æ—Ä—è–¥–∫–µ –º—ã —Ç–µ–ø–µ—Ä—å –¥–æ–≤–µ—Ä—è–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º, –∏ —á—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ.

1. –ö–∞–∫–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –º—ã –°–ß–ò–¢–ê–ï–ú –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω—ã–º–∏

–°–ø–∏—Å–æ–∫ –≤ –ø–æ—Ä—è–¥–∫–µ –¥–æ–≤–µ—Ä–∏—è:

1. BX24.placement.info().options.ID

–≠—Ç–æ —Å–∞–º—ã–π –Ω–∞–¥—ë–∂–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç. –≠—Ç–æ –ø—Ä—è–º ¬´–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±¬ª, –∫–æ–≥–¥–∞ Bitrix –≤–µ–¥—ë—Ç —Å–µ–±—è —Ö–æ—Ä–æ—à–æ.

–ü—Ä–∏–∑–Ω–∞–∫–∏:

placement –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ CRM_DYNAMIC_176_DETAIL_TAB

options = –æ–±—ä–µ–∫—Ç

options.ID —ç—Ç–æ —Å—Ç—Ä–æ–∫–∞ —Ü–∏—Ñ—Ä "303"

–ï—Å–ª–∏ —Ç–∞–∫ ‚Äî –≤–æ–æ–±—â–µ —Å—É–ø–µ—Ä, –¥–∞–∂–µ –Ω–µ –¥—É–º–∞–µ–º.

2. document.referrer + –Ω–∞—à extractIdFromReferrer()

–≠—Ç–æ –Ω–∞—à "–±–æ–µ–≤–æ–π fallback", –∫–æ—Ç–æ—Ä—ã–π –º—ã —É–∂–µ –≤—Å—Ç—Ä–æ–∏–ª–∏.

–†–∞–±–æ—Ç–∞–µ—Ç, –∫–æ–≥–¥–∞ Bitrix –∑–∞–≥—Ä—É–∂–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤–æ –≤–∫–ª–∞–¥–∫—É –∫–∞—Ä—Ç–æ—á–∫–∏, –∏ –≤ —Ä–µ—Ñ–µ—Ä–µ—Ä–µ –µ—Å—Ç—å –ø—É—Ç—å –≤–∏–¥–∞:
/crm/type/176/details/179/?...

–ú—ã –¥–µ–ª–∞–µ–º:

new URL(document.referrer).pathname

—Å–ø–ª–∏—Ç –ø–æ /

–∏—â–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∏—Å—Ç–æ —Ü–∏—Ñ—Ä–æ–≤–æ–π —Å–µ–≥–º–µ–Ω—Ç

–±–µ—Ä—ë–º "179"

–≠—Ç–æ –Ω–∞–¥—ë–∂–Ω–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ:

–º—ã —Ä–µ–∞–ª—å–Ω–æ –ø–æ–ª—É—á–∞–µ–º –∏–º–µ–Ω–Ω–æ ID —ç–ª–µ–º–µ–Ω—Ç–∞ —Å–º–∞—Ä—Ç-–ø—Ä–æ—Ü–µ—Å—Å–∞ (—Ç–æ, —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ –¥–ª—è crm.item.get)

Bitrix —á–∞—Å—Ç–æ –ø—Ä–æ–∫–∏–¥—ã–≤–∞–µ—Ç —ç—Ç–æ –≤ —Å–∞–π–¥-—Å–ª–∞–π–¥–µ—Ä–µ

—ç—Ç–æ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–≤–æ–µ–≥–æ —Ä–æ—É—Ç–∏–Ω–≥–∞ (/install vs /)

–≠—Ç–æ –≤—Ç–æ—Ä–∞—è –ª–∏–Ω–∏—è –∑–∞—â–∏—Ç—ã –∏ –æ–Ω–∞ —Ö–æ—Ä–æ—à–∞—è.

3. window.location.pathname

–≠—Ç–æ –º–æ–∂–µ—Ç —Å—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ Bitrix –≥—Ä—É–∑–∏—Ç iframe —Ç–∞–∫:
https://—Ç–≤–æ–π-–ø—Ä–æ–µ–∫—Ç.replit.app/179/?IFRAME=Y...

–ò–Ω–æ–≥–¥–∞ –æ–Ω —Ç–∞–∫ –¥–µ–ª–∞–µ—Ç (–æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –±—ã—Å—Ç—Ä—ã—Ö –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞—Ö), –Ω–æ –Ω–µ –≤—Å–µ–≥–¥–∞. –£ –Ω–∞—Å —É–∂–µ –±—ã–ª –ª–æ–≥:

PRIORITY 0 - pathname: /install segments: ['install']


–¢—É—Ç –≤–æ–æ–±—â–µ –Ω–µ—Ç —á–∏—Å–ª–∞, –∑–Ω–∞—á–∏—Ç –≤ —Ç–∞–∫–æ–º —Ä–µ–∂–∏–º–µ —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –±–µ—Å–ø–æ–ª–µ–∑–µ–Ω. –ù–æ –º—ã –≤—Å—ë —Ä–∞–≤–Ω–æ –º–æ–∂–µ–º –¥–µ—Ä–∂–∞—Ç—å –µ–≥–æ –∫–∞–∫ "–ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞ –≤–¥—Ä—É–≥ –ø–æ–≤–µ–∑–ª–æ".

üëâ –¢–æ –µ—Å—Ç—å —ç—Ç–æ –Ω–∏–∑–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞: –µ—Å–ª–∏/–∫–æ–≥–¥–∞ –ø—É—Ç—å —Ä–µ–∞–ª—å–Ω–æ –±—É–¥–µ—Ç /303/, –º—ã –µ–≥–æ —Å—Ö–≤–∞—Ç–∏–º. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –Ω—É –∏ –ª–∞–¥–Ω–æ.

‚ùå window.name

–ú—ã –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ –¢–ï–ü–ï–†–¨ —Å—á–∏—Ç–∞–µ–º —ç—Ç–æ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –±–∏–∑–Ω–µ—Å-ID:

–ï—Å–ª–∏ —Ç–∞–º –≤—Å–µ–≥–¥–∞ 24, –∑–Ω–∞—á–∏—Ç —ç—Ç–æ –Ω–µ ID —Å–º–∞—Ä—Ç-–ø—Ä–æ—Ü–µ—Å—Å–∞.

–≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å ID —Å–µ—Å—Å–∏–∏ –∏–ª–∏ –Ω–æ–º–µ—Ä iframe –≤ —Å–ª–∞–π–¥–µ—Ä–µ.

–ú—ã –Ω–µ –º–æ–∂–µ–º –ø–æ–¥—Å—Ç–∞–≤–ª—è—Ç—å 24 –≤ crm.item.get ‚Äî —ç—Ç–æ –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ —á—Ç–µ–Ω–∏—é –Ω–µ —Ç–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏ –∏–ª–∏ –∫ –æ—à–∏–±–∫–µ.

üí° –ó–Ω–∞—á–∏—Ç —ç—Ç–æ—Ç —à–∞–≥ —Å–Ω–∏–º–∞–µ–º –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è entityId. –û—Å—Ç–∞–≤–ª—è–µ–º window.name –¢–û–õ–¨–ö–û –≤ –ª–æ–≥–∞—Ö –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –Ω–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫ ID.

2. –ö–∞–∫ –Ω–∞–¥–æ —Ç–µ–ø–µ—Ä—å —É—Å—Ç—Ä–æ–∏—Ç—å resolveContext()

–°–µ–π—á–∞—Å –ª–æ–≥–∏–∫–∞ –¥–æ–ª–∂–Ω–∞ –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫ (–ª–æ–≥–∏–∫–∞ –≤ —Å–ª–æ–≤–∞—Ö –∏ –ø–æ—Ç–æ–º –ø—Å–µ–≤–¥–æ–∫–æ–¥):

–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥–æ—Å—Ç–∞—Ç—å entityTypeId –∏–∑ placement –∏–º–µ–Ω–∏ CRM_DYNAMIC_176_DETAIL_TAB ‚Üí "176".

–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥–æ—Å—Ç–∞—Ç—å entityId –∏–∑ placement.options (–µ—Å–ª–∏ options —ç—Ç–æ –æ–±—ä–µ–∫—Ç, –∞ –Ω–µ []).

–ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å ‚Äî –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –≤—ã—Ç–∞—â–∏—Ç—å entityId –∏–∑ document.referrer.

–ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å ‚Äî –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∏–∑ window.location.pathname.

–ï—Å–ª–∏ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—Å—ë –µ—â—ë –Ω–µ—Ç entityId ‚Üí —á–µ—Å—Ç–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —ç–∫—Ä–∞–Ω "–∫–æ–Ω—Ç–µ–∫—Å—Ç –Ω–µ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω", –ù–ï –≤—ã–∑—ã–≤–∞—Ç—å crm.item.get.

–ò –í–°–Å. window.name –≤ —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫ –Ω–µ –≤—Ö–æ–¥–∏—Ç.

–í–æ—Ç –∫–∞–∫ —ç—Ç–æ –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –≤ –∫–æ–¥–µ:

function extractIdFromReferrer(ref) {
  try {
    if (!ref) return null;
    const url = new URL(ref);
    const parts = url.pathname.split('/').filter(Boolean); // ['crm','type','176','details','179']
    for (let i = parts.length - 1; i >= 0; i--) {
      if (/^\d+$/.test(parts[i])) {
        return parts[i]; // "179"
      }
    }
    return null;
  } catch (e) {
    console.warn('[extractIdFromReferrer] –Ω–µ —Å–º–æ–≥ —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å referrer:', ref, e);
    return null;
  }
}

function extractIdFromPathname(pathname) {
  if (!pathname) return null;
  // –ø—Ä–∏–º–µ—Ä—ã:
  // "/install"            => ["install"]    => –Ω–µ—Ç
  // "/179/"               => ["179"]        => –≤–µ—Ä–Ω—ë–º "179"
  // "/179"                => ["179"]        => –≤–µ—Ä–Ω—ë–º "179"
  const parts = pathname.split('/').filter(Boolean);
  if (parts.length === 1 && /^\d+$/.test(parts[0])) {
    return parts[0];
  }
  return null;
}

function resolveContextWithRetries(maxAttempts, cb) {
  let attempt = 1;

  function tryOnce() {
    BX24.placement.info(function(info) {
      const placementName = info?.placement || '';
      let entityTypeId = null;
      let entityId = null;
      let extractionMethod = null;

      // 1. entityTypeId –∏–∑ placement
      const m = /^CRM_DYNAMIC_(\d+)_DETAIL_TAB$/.exec(placementName);
      if (m) {
        entityTypeId = m[1]; // "176"
      }

      // 2. ID –∏–∑ placement.options
      const opt = info?.options;
      // –≤–∞–∂–Ω–æ: –º–∞—Å—Å–∏–≤ vs –æ–±—ä–µ–∫—Ç
      if (opt && !Array.isArray(opt) && typeof opt === 'object') {
        if (typeof opt.ID === 'string' && /^\d+$/.test(opt.ID)) {
          entityId = opt.ID;
          extractionMethod = 'placement.options.ID';
        } else if (typeof opt.id === 'string' && /^\d+$/.test(opt.id)) {
          entityId = opt.id;
          extractionMethod = 'placement.options.id';
        }
      }

      // 3. –µ—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ ‚Äî referrer
      if (!entityId) {
        const guessFromRef = extractIdFromReferrer(document.referrer);
        if (guessFromRef) {
          entityId = guessFromRef;
          extractionMethod = 'document.referrer';
        }
      }

      // 4. –µ—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ ‚Äî pathname —ç–≤—Ä–∏—Å—Ç–∏–∫–∞
      if (!entityId) {
        const guessFromPath = extractIdFromPathname(window.location.pathname);
        if (guessFromPath) {
          entityId = guessFromPath;
          extractionMethod = 'window.location.pathname';
        }
      }

      // 5. –ª–æ–≥–∏—Ä—É–µ–º –≤—Å—ë, –Ω–æ window.name —Ç–æ–ª—å–∫–æ –∫–∞–∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É
      console.log("üìã CONTEXT TRY (–ò–¢–û–ì–û–í–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢):", {
        attempt,
        entityId: entityId || "‚ùå –ù–ï –ù–ê–ô–î–ï–ù",
        entityTypeId: entityTypeId || "‚ùå",
        extractionMethod: extractionMethod || "‚ùå none",
        placement: placementName,
        options: opt,
        referrer: document.referrer || "‚ùå –ø—É—Å—Ç–æ",
        pathname: window.location.pathname,
        search: window.location.search,
        windowName: window.name // –ø—Ä–æ—Å—Ç–æ —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å 'mitclick...|1|...'
      });

      if (entityId || attempt >= maxAttempts) {
        cb({
          entityId: entityId || null,
          entityTypeId: entityTypeId || null,
          extractionMethod: extractionMethod || null
        });
      } else {
        attempt++;
        setTimeout(tryOnce, 100);
      }
    });
  }

  tryOnce();
}


–≠—Ç–æ –¥–µ–ª–∞–µ—Ç —Ç—Ä–∏ –ø–æ–ª–µ–∑–Ω—ã—Ö –≤–µ—â–∏:

–ü–µ—Ä–µ—Å—Ç–∞—ë—Ç –¥–æ–≤–µ—Ä—è—Ç—å window.name –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫ ID –∫–∞—Ä—Ç–æ—á–∫–∏.

–ü—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å window.name, —á—Ç–æ–±—ã –º—ã –≤–∏–¥–µ–ª–∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ Bitrix.

–ß—ë—Ç–∫–æ –ø–æ–º–µ—á–∞–µ—Ç extractionMethod, —á—Ç–æ–±—ã —Ç—ã —Å—Ä–∞–∑—É –ø–æ–Ω–∏–º–∞–ª, –∫–∞–∫–æ–π –ø—É—Ç—å —Ä–µ–∞–ª—å–Ω–æ —Å—Ä–∞–±–æ—Ç–∞–ª.

3. –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –ø–æ—Å–ª–µ –≤—Å–µ—Ö —à–∞–≥–æ–≤ entityId –≤—Å—ë –µ—â—ë null

–≠—Ç–æ —Ç–µ–ø–µ—Ä—å —á–µ—Å—Ç–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:
Bitrix24 –Ω–µ –¥–∞–ª ID –≤ options, –Ω–µ –¥–∞–ª ID –≤ referrer, –Ω–µ –¥–∞–ª ID –Ω–∏ –≤ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ, –∏ iframe –∑–∞–∫—Ä—ã–ª –Ω–∞–º –¥–æ—Å—Ç—É–ø –∫ parent-URL (–∏–∑-–∑–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–æ–º–µ–Ω–æ–≤). –¢–∞–∫–æ–µ –±—ã–≤–∞–µ—Ç.

–î–µ–π—Å—Ç–≤–∏—è –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ:

–ù–ï –¥–µ–ª–∞—Ç—å crm.item.get.

–ü–æ–∫–∞–∑–∞—Ç—å –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π —ç–∫—Ä–∞–Ω –≤–Ω—É—Ç—Ä–∏ –≤–∫–ª–∞–¥–∫–∏:

–∑–∞–≥–æ–ª–æ–≤–æ–∫:
–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ

—Ç–µ–∫—Å—Ç:
–û—Ç–∫—Ä–æ–π—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É —Å–º–∞—Ä—Ç-–ø—Ä–æ—Ü–µ—Å—Å–∞ "–°–æ–±—ã—Ç–∏–µ" –ø–æ–ª–Ω–æ—Å—Ç—å—é (–Ω–µ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å–±–æ–∫—É), –∑–∞—Ç–µ–º —Å–Ω–æ–≤–∞ –Ω–∞–∂–º–∏—Ç–µ –≤–∫–ª–∞–¥–∫—É "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø–æ–π".

—Ç–µ—Ö.—Å—Ç—Ä–æ–∫–∞ –º–µ–ª–∫–∏–º —Å–µ—Ä—ã–º (–¥–ª—è —Ç–µ–±—è):
entityTypeId: 176 | source: ${extractionMethod || 'none'}

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–Ω–∏–º–∞–µ—Ç, —á—Ç–æ –¥–µ–ª–∞—Ç—å.
–¢—ã –Ω–µ –ª–æ–º–∞–µ—à—å—Å—è.
–ö–æ–Ω—Å–æ–ª—å –Ω–µ –∑–∞–ª–∏–≤–∞–µ—Ç—Å—è –∫—Ä–∞—Å–Ω—ã–º–∏ –æ—à–∏–±–∫–∞–º–∏.

–≠—Ç–æ –∏ –µ—Å—Ç—å –ø—Ä–æ–¥–æ–≤–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ.

4. –ß—Ç–æ –¥–µ–ª–∞—Ç—å —Å /install –∏ 404

–¢–≤–æ—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å /install –≤—Å—ë –µ—â—ë –≤–∞–∂–Ω–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ:

/install —Ç–µ–±–µ –Ω—É–∂–µ–Ω –∫–∞–∫ —Å–µ—Ä–≤–∏—Å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–ª—è –ø–µ—Ä–µ–ø—Ä–∏–≤—è–∑–∫–∏ placement —á–µ—Ä–µ–∑ placement.unbind/placement.bind.

–°–µ–π—á–∞—Å Bitrix –∏–Ω–æ–≥–¥–∞ –≤–∏–¥–∏—Ç —Ç–∞–º 404 ‚Üí –∑–Ω–∞—á–∏—Ç Express –Ω–µ –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç /install* —Å—Ç–∞–±–∏–ª—å–Ω–æ.

–¢—É—Ç —Ä–µ—à–µ–Ω–∏–µ —Ç–æ –∂–µ, —á—Ç–æ —è –¥–∞–ª –≤—ã—à–µ: —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ä–æ—É—Ç.

–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è:

app.get(['/install', '/install/*'], (req, res) => {
  console.log('[/install handler]', {
    path: req.path,
    originalUrl: req.originalUrl,
    query: req.query,
  });

  // –≤–µ—Ä–Ω–∏ —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É - —Ç—É, –≥–¥–µ —É —Ç–µ–±—è –∫–Ω–æ–ø–∫–∞ "–ü—Ä–∏–≤—è–∑–∞—Ç—å –∑–∞–Ω–æ–≤–æ"
  res.sendFile(path.join(__dirname, 'dist', 'install.html'));
});


–ì–ª–∞–≤–Ω–∞—è —Ü–µ–ª—å:

–Ω–∏–∫–∞–∫–æ–≥–æ 404 –≤–Ω—É—Ç—Ä–∏ Bitrix

–º—ã —Ç–æ—á–Ω–æ –≤–∏–¥–∏–º, –ö–ê–ö–û–ô URL —Ä–µ–∞–ª—å–Ω–æ –ø—Ä–∏–ª–µ—Ç–∞–µ—Ç —Å –ø–æ—Ä—Ç–∞–ª–∞

–º—ã –ø–æ–Ω–∏–º–∞–µ–º, –≤ –∫–∞–∫–æ–º —Ä–µ–∂–∏–º–µ –ø–æ—Ä—Ç–∞–ª –ø—ã—Ç–∞–µ—Ç—Å—è –ø—Ä–æ–≥–Ω–∞—Ç—å auto-bind