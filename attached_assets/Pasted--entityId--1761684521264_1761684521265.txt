–¢–µ–ø–µ—Ä—å –º—ã –≤–∏–¥–∏–º –í–°–Æ –∫–∞—Ä—Ç–∏–Ω—É –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏, –∏ –º–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å —Ç–æ—á–Ω–æ, –ø–æ—á–µ–º—É entityId —Ç–∞–∫ –∏ –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ —Ç—Ä—ë—Ö –ø–æ–ø—ã—Ç–æ–∫.

–°–º–æ—Ç—Ä–∏, —á—Ç–æ —É —Ç–µ–±—è —Å–µ–π—á–∞—Å –≤ –ª–æ–≥–∞—Ö:

‚ö†Ô∏è [–ü–æ–ø—ã—Ç–∫–∞ 1] entityId –Ω–µ –Ω–∞–π–¥–µ–Ω. –ë—É–¥–µ—Ç –ø–æ–≤—Ç–æ—Ä...
üìã –ò–¢–û–ì–û–í–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢: {
  entityId: '‚ùå –ù–ï –ù–ê–ô–î–ï–ù',
  entityTypeId: '176',
  attempt: 1,
  placement: 'CRM_DYNAMIC_176_DETAIL_TAB',
  pathname: '/install',
  ...
}
‚è≥ –ü–æ–≤—Ç–æ—Ä —á–µ—Ä–µ–∑ 100ms (–ø–æ–ø—ã—Ç–∫–∞ 2/3)...
üìã –ò–¢–û–ì–û–í–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢: {
  entityId: '‚ùå –ù–ï –ù–ê–ô–î–ï–ù',
  entityTypeId: '176',
  attempt: 2,
  placement: 'CRM_DYNAMIC_176_DETAIL_TAB',
  pathname: '/install',
  ...
}
‚è≥ –ü–æ–≤—Ç–æ—Ä —á–µ—Ä–µ–∑ 100ms (–ø–æ–ø—ã—Ç–∫–∞ 3/3)...
üìã –ò–¢–û–ì–û–í–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢: {
  entityId: '‚ùå –ù–ï –ù–ê–ô–î–ï–ù',
  entityTypeId: '176',
  attempt: 3,
  placement: 'CRM_DYNAMIC_176_DETAIL_TAB',
  pathname: '/install',
  ...
}


–∏ —Å–≤–µ—Ä—Ö—É:

179/?categoryId=15&IFRAME=Y&IFRAME_TYPE=SIDE_SLIDER


–¢–æ –µ—Å—Ç—å:

Bitrix24 –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–≤–æ—ë –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤–æ –≤–∫–ª–∞–¥–∫–µ —Å–º–∞—Ä—Ç-–ø—Ä–æ—Ü–µ—Å—Å–∞ (CRM_DYNAMIC_176_DETAIL_TAB) ‚úÖ

–ú—ã —É—Å–ø–µ—à–Ω–æ –≤—ã—Ç–∞—â–∏–ª–∏ entityTypeId = 176 ‚úÖ

–ù–æ info.options –æ—Å—Ç–∞—ë—Ç—Å—è –ø—É—Å—Ç—ã–º –≤—Å–µ 3 —Ä–∞–∑–∞ ‚Üí —Ç–∞–º –Ω–µ—Ç ID, —Ç–æ –µ—Å—Ç—å –Ω–∞–º –Ω–µ –¥–∞—é—Ç entityId.

–ü—Ä–∏ —ç—Ç–æ–º —Ç–≤–æ–π —Ñ—Ä–æ–Ω—Ç —Å–∞–º —Å–æ–æ–±—â–∞–µ—Ç, —á—Ç–æ —Ç–µ–∫—É—â–∏–π –ø—É—Ç—å –≤–Ω—É—Ç—Ä–∏ iframe ‚Äî /install. ‚ùó

–≠—Ç–æ –≤–∞–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç. –≠—Ç–æ –∫–∞–∫ —Ä–∞–∑ –ø—Ä–∏—á–∏–Ω–∞, –ø–æ—á–µ–º—É entityId –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è.

–ß—Ç–æ —ç—Ç–æ –¥–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å

–¢–≤–æ–π placement –≤ Bitrix24 –ø—Ä–∏–≤—è–∑–∞–Ω –∫ URL, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–Ω–¥–µ—Ä–∏—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É /install –≤–Ω—É—Ç—Ä–∏ —Ç–≤–æ–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
(–∏–ª–∏ —Ç–≤–æ–π —Ä–æ—É—Ç–µ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ /install –≤–Ω—É—Ç—Ä–∏ SPA)

–°—Ç—Ä–∞–Ω–∏—Ü–∞ /install ‚Äî —ç—Ç–æ "—Ä–µ–∂–∏–º —É—Å—Ç–∞–Ω–æ–≤–∫–∏ / —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ / –æ—Ç–ª–∞–¥–∫–∏".
–í –Ω—ë–º —Ç—ã –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—à—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å–º–∞—Ä—Ç-–ø—Ä–æ—Ü–µ—Å—Å–∞, —Ç—ã –ø—Ä–æ—Å—Ç–æ –∑–∞–≥—Ä—É–∂–∞–µ—à—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä—å —Å–ª–∞–π–¥–µ—Ä–∞.
–í —ç—Ç–æ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏ Bitrix24 –Ω–µ –ø—Ä–æ–∫–∏–¥—ã–≤–∞–µ—Ç options.ID, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ entityId –Ω–µ—Ç.

–ü–æ—ç—Ç–æ–º—É —Ç–≤–æ–π –∫–æ–¥ —á–µ—Å—Ç–Ω–æ –ø—ã—Ç–∞–µ—Ç—Å—è —Ç—Ä–∏ —Ä–∞–∑–∞:
‚Üí "–µ—Å—Ç—å ID? –Ω–µ—Ç..."
‚Üí "–∞ —Å–µ–π—á–∞—Å?" –Ω–µ—Ç...
‚Üí "–∞ —Å–µ–π—á–∞—Å?" –Ω–µ—Ç...
‚Üí –∏ –≤ —Ñ–∏–Ω–∞–ª–µ –≤—ã–≤–æ–¥–∏—Ç "entityId ‚ùå –ù–ï –ù–ê–ô–î–ï–ù".

–¢–æ –µ—Å—Ç—å —ç—Ç–æ –Ω–µ –±–∞–≥ SDK, –Ω–µ –±–∞–≥ retry, –Ω–µ –±–∞–≥ —Ç–≤–æ–µ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞.
–≠—Ç–æ –ø–æ—Ç–æ–º—É —á—Ç–æ —Ç—ã —Ä–µ–∞–ª—å–Ω–æ –≤—Å—ë –µ—â—ë –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—à—å "–±–æ–µ–≤–æ–π —ç–∫—Ä–∞–Ω", —Ç—ã –æ—Ç–∫—Ä—ã–≤–∞–µ—à—å "—É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É".

–ü–æ—á–µ–º—É –º—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —ç—Ç–æ /install –ª–æ–º–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç

–°–º–æ—Ç—Ä–∏ –Ω–∞ —Å—Ç—Ä–æ–∫—É –≤ —Ç–≤–æ—ë–º –ª–æ–≥–µ:

pathname: '/install'


–≠—Ç–æ —Ç—ã —Å–∞–º –ª–æ–≥–∏—Ä—É–µ—à—å window.location.pathname –≤–Ω—É—Ç—Ä—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.

–≠—Ç–æ —á—ë—Ç–∫–∏–π –º–∞—Ä–∫–µ—Ä.
Bitrix24 –≥—Ä—É–∑–∏—Ç iframe ‚Üí iframe –∏–¥—ë—Ç –Ω–∞ /install ‚Üí –∞ /install ‚Äî —ç—Ç–æ –Ω–µ "–∫–∞—Ä—Ç–æ—á–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–∞", —ç—Ç–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.
Bitrix24 –≤ —Ç–∞–∫–æ–º —Ä–µ–∂–∏–º–µ: "–û–∫–µ–π, —è –æ—Ç–∫—Ä—ã–ª —Ç–µ–±–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–∞–∫ –≤–∏–¥–∂–µ—Ç, –Ω–æ —è –Ω–µ –æ–±—è–∑–∞–Ω –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å–º–∞—Ä—Ç-–ø—Ä–æ—Ü–µ—Å—Å–∞".

–ö–æ–≥–¥–∞ —Ç—ã —Ä–∞–Ω—å—à–µ –æ—Ç–∫—Ä—ã–≤–∞–ª —Ä–µ–∞–ª—å–Ω—É—é –≤–∫–ª–∞–¥–∫—É –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å–º–∞—Ä—Ç-–ø—Ä–æ—Ü–µ—Å—Å–∞, —É —Ç–µ–±—è –≤ –ª–æ–≥–∞—Ö –±—ã–ª–∏ —Ç–∞–∫–∏–µ —à—Ç—É–∫–∏:

placementInfo: { placement: "CRM_DYNAMIC_176_DETAIL_TAB", options: { ID: "303" } }
Found entityId in options.ID: 303


–¢–∞–º –Ω–µ –±—ã–ª–æ /install, —Ç–∞–º –±—ã–ª —É–∂–µ –¥—Ä—É–≥–æ–π –ø—É—Ç—å, –∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–ª–æ.

–¢–æ –µ—Å—Ç—å –º—ã —É–∂–µ –≤–∏–¥–µ–ª–∏ —Ä–∞–±–æ—á–∏–π –∫–µ–π—Å —Å entityId. –û–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –û–Ω –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º. –û–Ω –¥–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ Bitrix —Ä–µ–∞–ª—å–Ω–æ –æ—Ç–¥–∞—ë—Ç ID, –ù–û —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ —Ç—ã —Ä–µ–∞–ª—å–Ω–æ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ä—Ç–æ—á–∫–∏ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏ —Ç–≤–æ—è –≤–∫–ª–∞–¥–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "–±–æ–µ–≤–æ–π" UI, –∞ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫.

–ß—Ç–æ –Ω–∞–¥–æ —Å–¥–µ–ª–∞—Ç—å —Å–µ–π—á–∞—Å, —á—Ç–æ–±—ã entityId –±—ã–ª –≤—Å–µ–≥–¥–∞

–≠—Ç–æ —É–∂–µ –Ω–µ –ø—Ä–æ JavaScript. –≠—Ç–æ –ø—Ä–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é placement (—Ä–∞–∑–º–µ—â–µ–Ω–∏—è) –≤ Bitrix24.

–¢–µ–±–µ –Ω—É–∂–Ω–æ:

–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ handler —É placement CRM_DYNAMIC_176_DETAIL_TAB —É–∫–∞–∑—ã–≤–∞–µ—Ç –ù–ï –Ω–∞ /install, –∞ –Ω–∞ "–±–æ–µ–≤—É—é" —Å—Ç—Ä–∞–Ω–∏—Ü—É (–Ω–∞–∑–æ–≤–∏ –µ—ë, –Ω–∞–ø—Ä–∏–º–µ—Ä, /app –∏–ª–∏ /index –∏–ª–∏ /).

–ü—Ä–∏–º–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ:

HANDLER = https://travel-group-manager-ndt72.replit.app/
TITLE = "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø–∞–º–∏"
PLACEMENT = "CRM_DYNAMIC_176_DETAIL_TAB"


–ü—Ä–∏–º–µ—Ä –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (—Ç–æ, —á—Ç–æ —É —Ç–µ–±—è —Å–µ–π—á–∞—Å –ø–æ —Ñ–∞–∫—Ç—É):

HANDLER = https://travel-group-manager-ndt72.replit.app/install


–ï—Å–ª–∏ —Å–µ–π—á–∞—Å Bitrix24 –Ω–µ –¥–∞—ë—Ç –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å placement, —Ç–æ:

–¥–µ–ª–∞–µ–º placement.unbind —Å–æ —Å—Ç–∞—Ä—ã–º URL

–∏ –ø–æ—Ç–æ–º placement.bind –∑–∞–Ω–æ–≤–æ, –Ω–æ —É–∂–µ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º URL

–ü—Ä–∏–º–µ—Ä JS-–∫–æ–¥–∞ –¥–ª—è –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ (–ª—É—á—à–µ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –∞–¥–º–∏–Ω—Å–∫–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ, –Ω–µ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º UI):

BX24.init(function() {
  BX24.callMethod(
    'placement.unbind',
    {
      PLACEMENT: 'CRM_DYNAMIC_176_DETAIL_TAB',
      HANDLER: 'https://travel-group-manager-ndt72.replit.app/install'
    },
    function(res1) {
      console.log('unbind result:', res1.error(), res1.data());

      BX24.callMethod(
        'placement.bind',
        {
          PLACEMENT: 'CRM_DYNAMIC_176_DETAIL_TAB',
          HANDLER: 'https://travel-group-manager-ndt72.replit.app/',
          TITLE: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø–∞–º–∏'
        },
        function(res2) {
          console.log('bind result:', res2.error(), res2.data());
        }
      );
    }
  );
});


–ß—Ç–æ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç:

—Å–ø–µ—Ä–≤–∞ –æ—Ç–≤—è–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ä—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ /install,

–ø–æ—Ç–æ–º –±–∏–Ω–¥–∏—Ç –Ω–æ–≤—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ /.

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Ç–≤–æ—è –≤–∫–ª–∞–¥–∫–∞ –±—É–¥–µ—Ç –≥—Ä—É–∑–∏—Ç—å / –≤–º–µ—Å—Ç–æ /install.

–í–Ω—É—Ç—Ä–∏ —Ç–≤–æ–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —É–±–µ–¥–∏c—å, —á—Ç–æ —Ä–æ—É—Ç / —Ä–µ–Ω–¥–µ—Ä–∏—Ç –ë–û–ï–í–û–ô UI (–≥—Ä—É–ø–ø—ã/—Ç—É—Ä–∏—Å—Ç—ã), –∞ –Ω–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç —Å—Ä–∞–∑—É –∂–µ –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ /install.

–¢–æ –µ—Å—Ç—å –µ—Å–ª–∏ —É —Ç–µ–±—è —Å–µ–π—á–∞—Å SPA –¥–µ–ª–∞–µ—Ç:

if (window.location.pathname === "/") {
  window.location.replace("/install");
}


‚Äî —ç—Ç–æ –Ω–∞–¥–æ —É–±—Ä–∞—Ç—å.