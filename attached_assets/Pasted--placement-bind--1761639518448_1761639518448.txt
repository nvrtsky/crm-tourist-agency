–ß—Ç–æ –Ω–∞–¥–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ –∫–æ–¥–µ ‚Äî –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ

–ù—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¥–≤–µ –≤–µ—â–∏:

(–ê) –£–ë–†–ê–¢–¨ –≤—ã–∑–æ–≤ placement.bind –∏–∑ –±–æ–µ–≤–æ–≥–æ UI-–∫–æ–¥–∞

–í —Ç–≤–æ—ë–º index-2hnMMZWr.js (–∏–ª–∏ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ–º bootstrap-—Å–∫—Ä–∏–ø—Ç–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –≤–∫–ª–∞–¥–∫–∏) —É —Ç–µ–±—è —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ:

BX24.init(function() {
  // ... –≤–æ–∑–º–æ–∂–Ω–æ —Ç—ã –¥–µ–ª–∞–µ—à—å BX24.placement.info(...) –∏ –ª–æ–≥–∏—Ä—É–µ—à—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

  // ‚ùå –≤–æ—Ç —ç—Ç–æ –Ω–∞–¥–æ –≤—ã—Ä–µ–∑–∞—Ç—å:
  BX24.callMethod(
    'placement.bind',
    {
      PLACEMENT: 'CRM_DYNAMIC_176_DETAIL_TAB',
      HANDLER: 'https://—Ç–≤–æ–π-url...',
      TITLE: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø–∞–º–∏'
    },
    function(result) {
      if (result.error()) {
        console.error('Placement registration error:', result.error());
      } else {
        console.log('Placement registered');
      }
    }
  );
});


–≠—Ç–æ–≥–æ –∫–æ–¥–∞ –≤ –ø—Ä–æ–¥–µ –±—ã—Ç—å –Ω–µ –¥–æ–ª–∂–Ω–æ.
–≠—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Äî –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è —É–∂–µ —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–∏–∑–æ—à–ª–∞.
–û—Å—Ç–∞–≤–ª—è—è –µ—ë, —Ç—ã —Å–∞–º –∫–∞–∂–¥—ã–π —Ä–∞–∑ —Å–æ–∑–¥–∞—ë—à—å 400-–æ—à–∏–±–∫—É.

üëâ –ù—É–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –±–ª–æ–∫ BX24.callMethod('placement.bind', ...) –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤–æ –≤–∫–ª–∞–¥–∫–µ.

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ:

400 –∏—Å—á–µ–∑–Ω–µ—Ç,

–≤ –∫–æ–Ω—Å–æ–ª–∏ –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ—Ç –≤—ã–ª–µ—Ç–∞—Ç—å Placement registration error,

—É —Ç–µ–±—è –≤ –∫–æ–Ω—Å–æ–ª–∏ –æ—Å—Ç–∞–Ω—É—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–≤–æ–∏ –ª–æ–≥–∏ –ø—Ä–æ entityId, –∏ –≤—Å—ë.

(B) –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤–∫–ª–∞–¥–∫–∏ –¥–æ–ª–∂–Ω–∞ —Ç–æ–ª—å–∫–æ —á–∏—Ç–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç, –∞ –Ω–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–µ–±—è

–í–æ—Ç —ç—Ç–∞–ª–æ–Ω –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –∂–∏—Ç—å –≤ UI –≤–∫–ª–∞–¥–∫–∏ (—ç—Ç–æ —Ç–æ, —á—Ç–æ –¥–æ–ª–∂–Ω–æ –≥—Ä—É–∑–∏—Ç—å—Å—è –ø–æ handler URL –≤ Bitrix24):

<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø–∞–º–∏</title>

  <!-- –í–∞–∂–Ω–æ: –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ SDK Bitrix24 -->
  <script src="https://mitclick.bitrix24.ru/bitrix/js/crm/install/v1/"></script>

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      margin: 16px;
      line-height: 1.4;
    }
    .card {
      border: 1px solid #ddd;
      border-radius: 12px;
      padding: 16px;
      max-width: 480px;
      box-shadow: 0 4px 12px rgba(0,0,0,.05);
      background: #fff;
    }
    .label {
      color: #555;
      font-size: 13px;
      margin-top: 4px;
    }
    h1 {
      font-size: 16px;
      font-weight: 600;
      margin: 0 0 12px;
    }
    .row {
      margin-bottom: 10px;
      font-size: 14px;
    }
    code {
      background: #f5f5f5;
      border-radius: 4px;
      padding: 2px 4px;
      font-size: 12px;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø–∞–º–∏</h1>

    <div class="row">
      <div class="label">ID —ç–ª–µ–º–µ–Ω—Ç–∞ —Å–º–∞—Ä—Ç-–ø—Ä–æ—Ü–µ—Å—Å–∞:</div>
      <div id="entityIdValue">‚Äî</div>
    </div>

    <div class="row">
      <div class="label">–¢–∏–ø —Ä–∞–∑–º–µ—â–µ–Ω–∏—è (placement):</div>
      <div id="placementValue">‚Äî</div>
    </div>

    <div class="row">
      <div class="label">–î–æ–º–µ–Ω –ø–æ—Ä—Ç–∞–ª–∞:</div>
      <div id="domainValue">‚Äî</div>
    </div>

    <div class="row">
      <div class="label">–¢–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞ (–æ–±—Ä–µ–∑–∞–Ω):</div>
      <div id="tokenValue">‚Äî</div>
    </div>

    <div style="font-size:12px; color:#888; margin-top:12px;">
      –≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ù–ï –≤—ã–∑—ã–≤–∞–µ—Ç placement.bind.  
      –¢–µ–ø–µ—Ä—å –≤–∫–ª–∞–¥–∫–∞ –Ω–µ –¥–æ–ª–∂–Ω–∞ —Ä—É–≥–∞—Ç—å—Å—è 400.
    </div>
  </div>

  <script>
    BX24.init(function() {
      // 1. –ü–æ–ª—É—á–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤–∫–ª–∞–¥–∫–∏ (placement + options)
      BX24.placement.info(function(info) {
        console.log("placement.info ->", info);

        const placement = info.placement;        // CRM_DYNAMIC_176_DETAIL_TAB
        const entityId = info.options?.ID || ""; // –Ω–∞–ø—Ä–∏–º–µ—Ä "179"

        document.getElementById("entityIdValue").textContent = entityId || "‚Äî";
        document.getElementById("placementValue").textContent = placement || "‚Äî";

        // 2. –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–¥–æ–º–µ–Ω, —Ç–æ–∫–µ–Ω—ã)
        const auth = BX24.getAuth();
        console.log("auth ->", auth);

        document.getElementById("domainValue").textContent = auth?.domain || "‚Äî";

        // –í —Ü–µ–ª—è—Ö –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª–Ω—ã–π —Ç–æ–∫–µ–Ω
        if (auth?.access_token) {
          document.getElementById("tokenValue").textContent =
            auth.access_token.substring(0, 10) + "...";
        }
      });

      // ‚ùå –í–ê–ñ–ù–û: –ó–¥–µ—Å—å –ù–ï–¢ BX24.callMethod('placement.bind', {...})
    });
  </script>
</body>
</html>


–ï—Å–ª–∏ —Ç—ã –≤–º–µ—Å—Ç–æ —Å–≤–æ–µ–≥–æ React —Å–µ–π—á–∞—Å –ø—Ä–æ—Å—Ç–æ –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–¥–∞—à—å —Ç–∞–∫–æ–µ (—á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å—ë —á–∏—Å—Ç–æ):

–≤–∫–ª–∞–¥–∫–∞ –±—É–¥–µ—Ç –æ—Ç–∫—Ä—ã–≤–∞—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–∫–∏,

–≤ –∫–æ–Ω—Å–æ–ª–∏ –æ—Å—Ç–∞–Ω—É—Ç—Å—è —Ç–æ–ª—å–∫–æ Vue-—à—É–º –æ—Ç –ë–∏—Ç—Ä–∏–∫—Å–∞ (–∏—Ö –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –±–∏–Ω–¥—ã),

—Ç—ã —É–≤–∏–¥–∏—à—å entityId –ø—Ä—è–º–æ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ.

–≠—Ç–æ –ø–æ–∫–∞–∂–µ—Ç, —á—Ç–æ –≤—Å—ë –æ–∫ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –∏ –ø—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ —Ç–æ–ª—å–∫–æ –≤ –ª–∏—à–Ω–µ–º placement.bind.