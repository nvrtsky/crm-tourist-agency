–°–µ–π—á–∞—Å –∫–∞—Ä—Ç–∏–Ω–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –∏ –¥–∏–∞–≥–Ω–æ–∑ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π.

–Ø –¥–∞–º —Ç–µ–±–µ –æ—á–µ–Ω—å –ø—Ä—è–º–æ–π next step, –±–µ–∑ –≤–æ–¥—ã, —á—Ç–æ–±—ã —Ç—ã –ø—Ä–æ—Å—Ç–æ —Å–¥–µ–ª–∞–ª –ø—Ä–∞–≤–∫—É –∏ –ø–æ–ª—É—á–∏–ª –Ω–∞–∫–æ–Ω–µ—Ü entityId.

–ß—Ç–æ –≤–∏–¥–Ω–æ –∏–∑ –ª–æ–≥–æ–≤

–ü–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ:

placement: 'CRM_DYNAMIC_176_DETAIL_TAB',
entityTypeId: '176',
pathname: '/install',
entityId: '‚ùå –ù–ï –ù–ê–ô–î–ï–ù',
attempt: 1 ... 3


–∏ –≤ —Å—Ç–µ–∫–µ –≤–∏–¥–Ω–æ, —á—Ç–æ –≤–∫–ª–∞–¥–∫–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å–º–∞—Ä—Ç-–ø—Ä–æ—Ü–µ—Å—Å–∞ (–≤–∏–¥–Ω–æ 127/?IFRAME=Y...), –∞ —ç—Ç–æ —Å—É–ø–µ—Ä.

–≠—Ç–æ –∑–Ω–∞—á–∏—Ç:

Bitrix24 —Ä–µ–∞–ª—å–Ω–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –≤–∫–ª–∞–¥–∫—É –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–∞ —Å–º–∞—Ä—Ç-–ø—Ä–æ—Ü–µ—Å—Å–∞ (—Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å ID = 127).

–û–Ω –∑–æ–≤—ë—Ç —Ç–≤–æ–π handler –Ω–∞ https://travel-group-manager-ndt72.replit.app/ (–º—ã —ç—Ç–æ —É–∂–µ –ø—Ä–æ–≤–µ—Ä–∏–ª–∏ —á–µ—Ä–µ–∑ placement.get).

–ù–û —Ç–≤–æ–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ —Å—Ä–∞–∑—É –∂–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –∂–∏—Ç—å –Ω–∞ –º–∞—Ä—à—Ä—É—Ç–µ /install. –≠—Ç–æ –≤–∏–¥–Ω–æ –ø–æ pathname: '/install' –≤ –∫–∞–∂–¥–æ–º –ª–æ–≥–µ.

–†–∞–∑ —Ç–≤–æ–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –≤ –∏—Ç–æ–≥–µ —Ä–µ–Ω–¥–µ—Ä–∏—Ç /install, Bitrix24 –Ω–µ –ø—Ä–∏—Å—ã–ª–∞–µ—Ç placement.options.ID, –∏ –ø–æ—ç—Ç–æ–º—É entityId –æ—Å—Ç–∞—ë—Ç—Å—è ‚ùå –ù–ï –ù–ê–ô–î–ï–ù.

–¢–æ –µ—Å—Ç—å –º—ã —Å–µ–π—á–∞—Å –≤ —Ç–∞–∫–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏:

–ø–æ—Ä—Ç–∞–ª —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚úÖ

–∫–æ–¥ —Ä–µ—Ç—Ä–∞—è —É–∂–µ –Ω–∞–ø–∏—Å–∞–Ω ‚úÖ

–æ—Å—Ç–∞–ª–æ—Å—å –æ–¥–Ω–æ: –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å /install –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

–ü—Ä—è–º–æ —ç—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –≤–µ—â—å, –∫–æ—Ç–æ—Ä–∞—è –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ–ª—É—á–µ–Ω–∏–µ entityId.

–ü–æ—á–µ–º—É Bitrix24 –Ω–µ –¥–∞—ë—Ç options.ID, –ø–æ–∫–∞ –º—ã –Ω–∞ /install

–ü–æ—Ç–æ–º—É —á—Ç–æ /install = –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π —ç–∫—Ä–∞–Ω —É—Å—Ç–∞–Ω–æ–≤–∫–∏.
–° —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –ë–∏—Ç—Ä–∏–∫—Å–∞ —ç—Ç–æ –∫–∞–∫ ¬´–º–∞—Å—Ç–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è¬ª, –∞ –Ω–µ ¬´–≤–∫–ª–∞–¥–∫–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ —Å–¥–µ–ª–∫–∏/—Å–æ–±—ã—Ç–∏—è¬ª.

–í —Ç–∞–∫–æ–º —Ä–µ–∂–∏–º–µ –æ–Ω –Ω–µ –æ–±—è–∑–∞–Ω –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ (ID —Å–º–∞—Ä—Ç-–ø—Ä–æ—Ü–µ—Å—Å–∞). –ü–æ—ç—Ç–æ–º—É info.options –ø—É—Å—Ç–æ–π, –∏ entityId –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∏ –≤ –ø–æ–ø—ã—Ç–∫–µ 1, –Ω–∏ –≤ 2, –Ω–∏ –≤ 3.

–ú—ã –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ —É–≤–∏–¥–µ–ª–∏ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ ‚Üí —ç—Ç–æ –Ω–µ –≥–æ–Ω–∫–∞, –Ω–µ –∑–∞–¥–µ—Ä–∂–∫–∞ –∏ –Ω–µ –±–∞–≥ SDK. –≠—Ç–æ –∏–º–µ–Ω–Ω–æ –ª–æ–≥–∏–∫–∞ —Ä–æ—É—Ç–∏–Ω–≥–∞ –≤ —Ç–≤–æ—ë–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.

–ß—Ç–æ –Ω–∞–¥–æ —Å–¥–µ–ª–∞—Ç—å –≤ –∫–æ–¥–µ (–ø—Ä—è–º–æ —Å–µ–π—á–∞—Å)
–¢–µ–±–µ –Ω—É–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å —Ä–æ—É—Ç–∏–Ω–≥/—Ä–µ–Ω–¥–µ—Ä —Ç–∞–∫, —á—Ç–æ–±—ã:

–°—Ç—Ä–∞–Ω–∏—Ü–∞ / (–∫–æ—Ä–µ–Ω—å) = —ç—Ç–æ –±–æ–µ–≤–æ–π —ç–∫—Ä–∞–Ω "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø–æ–π".

–°—Ç—Ä–∞–Ω–∏—Ü–∞ /install = —ç–∫—Ä–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞/–∞–¥–º–∏–Ω–∞ —Å –∫–Ω–æ–ø–∫–æ–π "–ø–µ—Ä–µ–ø—Ä–∏–≤—è–∑–∞—Ç—å placement".

–ò –±–æ–ª—å—à–µ –Ω–∏–∫–∞–∫–æ–≥–æ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ / ‚Üí /install –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.

–°–µ–π—á–∞—Å (—Å—É–¥—è –ø–æ –ª–æ–≥–∞–º) —É —Ç–µ–±—è –≤—Å—ë –µ—â—ë –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Ç–∞–∫:

Bitrix24 –≤—ã–∑—ã–≤–∞–µ—Ç /

—Ç–≤–æ–π –∫–æ–¥/—Ä–æ—É—Ç–µ—Ä –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç —Å / –Ω–∞ /install

–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∂–∏–≤—ë—Ç –Ω–∞ /install

–º—ã –ª–æ–≥–∏—Ä—É–µ–º pathname: '/install'

–∏ –Ω–µ –ø–æ–ª—É—á–∞–µ–º entityId.

–ù—É–∂–Ω–æ –æ—Ç —ç—Ç–æ–≥–æ —É–π—Ç–∏.

–ö–∞–∫ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –≤ –ø—Ä–∞–∫—Ç–∏–∫–µ (2 –≤–∞—Ä–∏–∞–Ω—Ç–∞)
–í–∞—Ä–∏–∞–Ω—Ç 1. –£ —Ç–µ–±—è –≤–∞–Ω–∏–ª—å–Ω—ã–π index.js –±–µ–∑ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞

–£–±–µ–¥–∏—Å—å, —á—Ç–æ —É —Ç–µ–±—è –ª–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ —ç–∫—Ä–∞–Ω–∞ –≤—ã–≥–ª—è–¥–∏—Ç –≤–æ—Ç —Ç–∞–∫:

BX24.init(function () {
  const path = window.location.pathname;

  if (path === '/install') {
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–¥–º–∏–Ω—Å–∫—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –∫–Ω–æ–ø–∫–æ–π –ø–µ—Ä–µ–ø—Ä–∏–≤—è–∑–∫–∏ placement
    renderInstallPage();
    return;
  }

  // <-- –í—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ: —ç—Ç–æ –±–æ–µ–≤–æ–π —ç–∫—Ä–∞–Ω
  renderMainPage(); // —Ç—É—Ç —Ç—ã –¥–µ–ª–∞–µ—à—å BX24.placement.info, retry, crm.item.get –∏ —Ç.–¥.
});


–¢–æ –µ—Å—Ç—å:

–ù–ï –¥–µ–ª–∞–µ–º window.location.replace('/install') –∫–æ–≥–¥–∞ –º—ã –Ω–∞ /.

–ù–ï –¥–µ–ª–∞–µ–º if (path !== '/install') redirect('/install').

/install –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –¢–û–õ–¨–ö–û –µ—Å–ª–∏ —Ä–µ–∞–ª—å–Ω–æ path === '/install'.

–í–∞—Ä–∏–∞–Ω—Ç 2. –£ —Ç–µ–±—è React Router

–ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —É —Ç–µ–±—è –Ω–µ –≤–æ—Ç —Ç–∞–∫ (–ø–ª–æ—Ö–æ):

<Routes>
  <Route path="/" element={<InstallPage />} />
  <Route path="/install" element={<InstallPage />} />
  <Route path="/app" element={<MainPage />} />
</Routes>


–∞ –≤–æ—Ç —Ç–∞–∫ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):

<Routes>
  {/* —ç—Ç–æ –±—É–¥–µ—Ç –æ—Ç–∫—Ä—ã–≤–∞—Ç—å—Å—è –≤–Ω—É—Ç—Ä–∏ –≤–∫–ª–∞–¥–∫–∏ —Å–º–∞—Ä—Ç-–ø—Ä–æ—Ü–µ—Å—Å–∞ */}
  <Route path="/" element={<MainPage />} />

  {/* —ç—Ç–æ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞/–∞–¥–º–∏–Ω–∞ —Ä—É–∫–∞–º–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ */}
  <Route path="/install" element={<InstallPage />} />
</Routes>


–ò —É–±–µ–¥–∏—Å—å, —á—Ç–æ –≤ MainPage –Ω–µ—Ç redirect-–∞ –Ω–∞ /install —Ç–∏–ø–∞:

useEffect(() => {
  navigate('/install');
}, []);


–∏–ª–∏ —á–µ–≥–æ-—Ç–æ –ø–æ—Ö–æ–∂–µ–≥–æ.

–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å—ë –∑–∞—Ä–∞–±–æ—Ç–∞–ª–æ –ø–æ—Å–ª–µ —ç—Ç–æ–π –ø—Ä–∞–≤–∫–∏

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ —Ç—ã —É–±—Ä–∞–ª —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /install –∏ —Å–¥–µ–ª–∞–ª / –±–æ–µ–≤–æ–π:

–í Bitrix24 –æ—Ç–∫—Ä–æ–π —Å–º–∞—Ä—Ç-–ø—Ä–æ—Ü–µ—Å—Å "–°–æ–±—ã—Ç–∏–µ".

–û—Ç–∫—Ä–æ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, ID=127). –í–∞–∂–Ω–æ: –Ω–µ —Å–ø–∏—Å–æ–∫, –∞ —Å–∞–º—É –∫–∞—Ä—Ç–æ—á–∫—É —ç–ª–µ–º–µ–Ω—Ç–∞. –¢–∞–º, –≥–¥–µ —Å–ø—Ä–∞–≤–∞ –≤–∫–ª–∞–¥–∫–∏.

–ü–µ—Ä–µ–π–¥–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø–æ–π".

–û—Ç–∫—Ä–æ–π DevTools ‚Üí Console –≤–Ω—É—Ç—Ä–∏ iframe (–ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –Ω–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º –≤–∫–ª–∞–¥–∫–∏ ‚Üí "–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ–¥", –∞ –Ω–µ –≥–ª–æ–±–∞–ª—å–Ω–æ –Ω–∞ –ø–æ—Ä—Ç–∞–ª–µ).

–ü–æ—Å–º–æ—Ç—Ä–∏ –ª–æ–≥–∏.

–û–∂–∏–¥–∞–µ–º–æ –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è —á—Ç–æ-—Ç–æ —Ç–∏–ø–∞:

üìã –ò–¢–û–ì–û–í–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢: {
  entityId: '127',
  entityTypeId: '176',
  attempt: 1,
  placement: 'CRM_DYNAMIC_176_DETAIL_TAB',
  pathname: '/'
}


—Ç.–µ. –Ω–µ '‚ùå –ù–ï –ù–ê–ô–î–ï–ù', –∞ '127'.

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Ç—ã –º–æ–∂–µ—à—å –±–µ–∑–æ–ø–∞—Å–Ω–æ –≤—ã–∑–≤–∞—Ç—å:

BX24.callMethod(
  'crm.item.get',
  {
    entityTypeId: 176,
    id: 127 // <-- —Ç–æ, —á—Ç–æ —Ç—ã –ø–æ–ª—É—á–∏–ª –∫–∞–∫ entityId
  },
  function(result) {
    console.log('crm.item.get data:', result.data());
    // –∑–¥–µ—Å—å —É–∂–µ –º–æ–∂–Ω–æ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å —Ç—É—Ä, –¥–∞—Ç—ã, —Å–ø–∏—Å–æ–∫ —Ç—É—Ä–∏—Å—Ç–æ–≤ –∏ —Ç.–¥.
  }
);


–ù–∞ —ç—Ç–æ–º –º–æ–º–µ–Ω—Ç–µ –ø—Ä–æ–¥—É–∫—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ "—á–∏—Ç–∞–µ—Ç –∫–∞—Ä—Ç–æ—á–∫—É —Å–º–∞—Ä—Ç-–ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –µ—ë –¥–∞–Ω–Ω—ã–µ".